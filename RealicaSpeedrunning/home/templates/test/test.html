<!DOCTYPE html>
<lang="en">
    <body>
        <style>
    
            .testbutton {
                border-radius: 10px;
                border: 2px solid #35455D;
                background-color: #BFD1DF;
                color: #35455D;
            }

            .homebutton {
                border-radius: 10px;
                border: 2px solid #4a532e;
                background-color: #CED2C2;
                color: #35455D;
                position: absolute;
                left: 1700px;
            }

            .textarea {
                position: absolute;
                top: 100px;
                left: 500px;
                width: 1100px;
            }

            .startendbutton {
                border-radius: 10px;
                border: 2px solid #4a532e;
                background-color: #CED2C2;
                color: #35455D;
            }

            .uncopytext {
                position: absolute;
                top: 100px;
                left: 500px;
                width: 1100px;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
        </style>

        {% load bootstrap5 %}
        {% bootstrap_css %}
        {% bootstrap_javascript %}

        <head>
            <h3 style="position:absolute; top:10px; left:20px">Tule ja katseta, kui julged. Vali tekst:</h3>
            <div>
                <form method="post" action="/home/">
                    {% csrf_token %}
                        <button type="submit" class="homebutton">Koju</button>
                </form>
            </div>
            <div style="position:absolute; left:50px; top:100px">
                <form method="post" action="/test/">
                    {% csrf_token %}
                        <dl>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1881-1890">Saksakeelne kool</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1890-1918" style="position:relative; top:10px">Venestamisaegne kool</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1918-1920" style="position:relative; top:20px">Wabadussõjaaegne kool</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1921-1940" style="position:relative; top:30px">I vabariigiaegne kool</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1941-1950" style="position:relative; top:40px">Sõjaaegne ja sõjajärgne kool</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1951-1960" style="position:relative; top:50px">Nõukogudeaegne kool 50-ndad</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1961-1970" style="position:relative; top:60px">Nõukogudeaegne kool 60-ndad</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1971-1980" style="position:relative; top:70px">Nõukogudeaegne kool 70-ndad</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1981-1990" style="position:relative; top:80px">Nõukogudeaegne kool 80-ndad</button></dt>
                            <dt><button type="submit" class="testbutton" name="test-type" value="1991-" style="position:relative; top:90px">Taasiseseisvumisjärgne kool</button></dt>
                        </dl>    
                </form>
            </div>
            <div>
                <p>
                    {% if text %}
                        <div class="uncopytext">
                            {{ text }}
                            {% if not state %}
                                <form method="post" action="/test/">
                                    {% csrf_token %}
                                    <button class="startendbutton" type="submit", name="action-start", value="start">Alusta testi</button>
                                </form>
                            {% endif %}
                            {% if state %}
                                <form method="post" action="/test/">
                                    {% csrf_token %}
                                    <textarea name="usertext" id="usertext" cols="256" rows="10" maxlength="{{maxlen}}" onkeyup="stop()" style="width: 1100px; resize: none;"></textarea>
                                    <button class="startendbutton" type="submit" id="submit" name="action-end" value="end">Lõpeta test</button>
                                </form>
                            {% endif %}
                        </div>
                        {% if usertext %}
                        <div class="textarea" style="position: relative; top: 450px;">
                            <h4>Sinu tulemus:</h4>
                                <h6>Kirjutatud tekst:</h6>
                                    <p>{{ usertext }}</p>
                                <h6>Aeg:</h6>
                                    <p>{{ timedelta }} sekundit</p>
                                <h6>Skoor:</h6>
                                    <p>{{ score }}%</p>
                                <h6>Sõnu sekundis:</h6>
                                    <p>{{ speed }} sõnu sekundis</p>    
                        </div>
                        {% endif %}
                    {% endif %}
                </p>
            </div>
            <script data-maxlen="{{maxlen}}">
                var maxlen = document.currentScript.dataset.maxlen;

                function stop() {
                    var x = document.getElementById("usertext").value;
                    
                    if (x.length >= Number(maxlen)) {
                        document.getElementById('submit').click();
                    }
                }
            </script>
        </head>
    </body>
</html>

<!-- Elu on ilus nagu peldik puude vilus
Elu on lill kui sees on promill
elu on lill kui pole till -->